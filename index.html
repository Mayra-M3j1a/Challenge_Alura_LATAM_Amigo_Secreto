<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amigo Secreto</title>
</head>
<body>
    <h1>Amigo Secreto</h1>
    <p>Ingresa los nombres de los participantes separados por comas:</p>
    <textarea id="nombres" rows="4" cols="50" placeholder="Ana, Carlos, María, Luis, Sofía"></textarea>
    <br><br>
    <button onclick="mostrarAsignaciones()">Generar Amigo Secreto</button>
    <h2>Resultados:</h2>
    <pre id="resultado"></pre>

    <script>
        // Función para mezclar la lista de nombres
        function mezclar(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Función principal para asignar amigos secretos
        function asignarAmigosSecretos(nombres) {
            if (nombres.length < 2) {
                alert("Debe haber al menos dos participantes.");
                return null;
            }

            // Mezclar la lista de nombres
            const mezclados = mezclar([...nombres]);
            const asignaciones = {};

            for (let i = 0; i < nombres.length; i++) {
                asignaciones[nombres[i]] = mezclados[i];
            }

            // Verificar que nadie se asigne a sí mismo
            for (const [nombre, asignado] of Object.entries(asignaciones)) {
                if (nombre === asignado) {
                    console.log("Se detectó una autoasignación. Reiniciando...");
                    return asignarAmigosSecretos(nombres); // Reiniciar en caso de error
                }
            }

            return asignaciones;
        }

        // Función para mostrar las asignaciones en la página
        function mostrarAsignaciones() {
            const input = document.getElementById("nombres").value;
            const nombres = input.split(",").map(nombre => nombre.trim()).filter(nombre => nombre);

            if (nombres.length < 2) {
                document.getElementById("resultado").textContent = "Debe haber al menos dos participantes.";
                return;
            }

            const resultado = asignarAmigosSecretos(nombres);

            if (resultado) {
                let textoResultado = "";
                for (const [nombre, asignado] of Object.entries(resultado)) {
                    textoResultado += `${nombre} → ${asignado}\n`;
                }
                document.getElementById("resultado").textContent = textoResultado;
            }
        }
    </script>
</body>
</html>

